namespace ObjMapper.Services.Pluralization;

/// <summary>
/// Russian irregular plurals dictionary.
/// </summary>
public sealed class RussianIrregulars : IrregularDictionary
{
    private static readonly Lazy<RussianIrregulars> _instance = new(() => new RussianIrregulars());
    public static RussianIrregulars Instance => _instance.Value;

    private readonly Dictionary<string, string> _singularToPlural = new(StringComparer.OrdinalIgnoreCase)
    {
        // Completely irregular
        { "человек", "люди" },
        { "ребёнок", "дети" },
        { "друг", "друзья" },
        { "брат", "братья" },
        { "сын", "сыновья" },
        { "стул", "стулья" },
        { "лист", "листья" },
        { "дерево", "деревья" },
        { "перо", "перья" },
        { "крыло", "крылья" },
        { "муж", "мужья" },
        { "князь", "князья" },
        
        // Stress-induced irregulars
        { "город", "города" },
        { "дом", "дома" },
        { "глаз", "глаза" },
        { "берег", "берега" },
        { "вечер", "вечера" },
        { "голос", "голоса" },
        { "доктор", "доктора" },
        { "директор", "директора" },
        { "мастер", "мастера" },
        { "номер", "номера" },
        { "остров", "острова" },
        { "паспорт", "паспорта" },
        { "поезд", "поезда" },
        { "профессор", "профессора" },
        { "учитель", "учителя" },
        
        // Words ending in consonant + fleeting vowel
        { "день", "дни" },
        { "пень", "пни" },
        { "угол", "углы" },
        { "огонь", "огни" },
        { "сон", "сны" },
        { "рот", "рты" },
        { "лёд", "льды" },
        { "лев", "львы" },
        { "лоб", "лбы" },
        
        // Neuter irregulars
        { "ухо", "уши" },
        { "око", "очи" },
        { "небо", "небеса" },
        { "чудо", "чудеса" },
        { "тело", "тела" },
        { "слово", "слова" },
        { "дело", "дела" },
        { "море", "моря" },
        { "поле", "поля" },
        
        // Collective/singularia tantum (no true plural or irregular)
        { "мать", "матери" },
        { "дочь", "дочери" },
        { "путь", "пути" },
        { "время", "времена" },
        { "имя", "имена" },
        { "знамя", "знамёна" },
        { "племя", "племена" },
        { "пламя", "пламена" },
        { "семя", "семена" },
        { "стремя", "стремена" },
        
        // Words with consonant mutations
        { "ухо", "уши" },
        { "небо", "небеса" },
        { "год", "годы" },
        { "цветок", "цветы" },
        { "цыплёнок", "цыплята" },
        { "ребёнок", "дети" },
        { "котёнок", "котята" },
        { "телёнок", "телята" },
        { "поросёнок", "поросята" },
        { "медвежонок", "медвежата" },
        
        // Computing terms
        { "сервер", "серверы" },
        { "пользователь", "пользователи" },
        { "файл", "файлы" },
        { "папка", "папки" },
        { "база", "базы" },
        { "данные", "данные" },
        { "интерфейс", "интерфейсы" },
    };

    protected override Dictionary<string, string> SingularToPlural => _singularToPlural;
}
